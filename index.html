
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USB-2C-WALLET - Cold Storage Interface</title>
    <style>
        body.dark-mode {
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  color: #f1f5f9;
}

.wallet-card.dark-mode {
  background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
  border: 1px solid #475569;
  color: #f1f5f9;
}
body.dark-mode {
  background: linear-gradient(135deg, #0f1115 0%, #1a1d22 100%);
  color: #e0e0e0;
}

.container.dark-mode {
  background-color: #1e2126;
  color: #f0f0f0;
  border: 1px solid #2c2f33;
  box-shadow: 0 0 12px rgba(0, 0, 0, 0.4);
}

.transaction-entry.dark-mode {
  background-color: #2a2d32;
  color: #dcdcdc;
  border-left: 4px solid #4ade80;
  padding: 10px;
  margin-bottom: 8px;
}

.button.dark-mode {
  background-color: #3a3f45;
  color: #f0f0f0;
  border: 1px solid #555;
  transition: background-color 0.3s ease;
}

.button.dark-mode:hover {
  background-color: #50555c;
}

.button.dark-mode {
  background-color: #475569;
  color: #f1f5f9;
  border: none;
}
body.dark-mode {
  background: linear-gradient(135deg, #1a1c1f 0%, #2a2d31 100%);
  color: #e0e0e0;
}
.container.dark-mode {
  background-color: #121212; /* negro profundo pero no absoluto */
  color: #e0e0e0; /* texto claro y suave */
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6);
  border: 1px solid #2c2c2c;
  transition: background-color 0.3s ease, color 0.3s ease;
}

.wallet-card.dark-mode {
  background-color: #2f3338;
  border: 1px solid #3e4349;
  color: #f0f0f0;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
}

.button.dark-mode {
  background-color: #3b3f45;
  color: #f0f0f0;
  border: 1px solid #555;
  transition: background-color 0.3s ease;
}

.button.dark-mode:hover {
  background-color: #50555c;
}

.transaction-entry.dark-mode {
  background-color: #2b2f34;
  color: #dcdcdc;
  border-left: 4px solid #4ade80;
  padding: 10px;
  margin-bottom: 8px;
}

    </style>
<link rel="stylesheet" href="USB-2C-WALLET-Installer-testnet.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí USB-2C-WALLET</h1>
            <p>Professional Cold Storage Interface - Offline Pi Coin Management</p>
            <p>GC6AT2DOD3QCRJSNDJJLZDIXQIT53FSK4YKNYMFZ5HVT5HXXHWQEI42UN</p>
        </div>
        <button onclick="toggleDarkMode()">üåô Dark Mode</button>

        <div class="content">
            <div class="status secure">
                ‚úÖ SECURE OFFLINE MODE - Your Pi Coins are safe in cold storage
            </div>
            
            <div class="tabs">
                <div class="tab active" onclick="showTab('wallet')">üí∞ Wallet</div>
                <div class="tab" onclick="showTab('security')">üîê Security</div>
                <div class="tab" onclick="showTab('transactions')">üìù Transactions</div>
                <div class="tab" onclick="showTab('backup')">üíæ Backup</div>
            </div>

            <div id="wallet" class="tab-content active">
                <div class="section">
                    <h2>üìÅ Wallet Management</h2>
<h3>Balance Total: <span id="balanceDisplay">0œÄ</span></h3>
<div id="transactionLog">
  <h3>Transacciones Realizadas</h3>
</div>

                    <div class="instructions">
                        <strong>Instructions:</strong>
                        <ol style="margin-left: 20px; margin-top: 8px;">
                            <li>Load wallet JSON files from your USB wallets/ folder</li>
                            <li>View Pi coin details and full image URLs</li>
                            <li>Download images from URLs when online</li>
                            <li>Manage your cold storage collection</li>
                        </ol>
                    </div>
                    
                    <div class="file-input">
                        <p><strong>Load Wallet Files:</strong></p>
                        <input type="file" id="walletFiles" multiple accept=".json" />
                        <button class="button" onclick="loadWallets()">Load Wallets</button>
                        <!--button class="button" onclick="generateNewWallet()">Generate New Wallet</button-->
                    </div>
                    
                    <div id="walletDisplay" class="wallet-grid">
                        <!-- Wallets will be displayed here -->
                    </div>
                </div>
            </div>
<button onclick="guardarHistorialEnUSB()">üíæ Guardar historial en USB</button>

            <div id="security" class="tab-content">
                <div class="section">
                    <h2>üîê Security Features</h2>
                    <div class="security-section">
                        <h3>üîë Private Key Management</h3>
                        <p><strong>Status:</strong> <span id="keyStatus">Not Generated</span></p>
                        <button class="button" onclick="generateKeys()">Generate New Keys</button>
                        <button class="button danger" onclick="clearKeys()">Clear Keys</button>
                        
                        <div id="keyDisplay" style="display: none;">
                            <h4>Wallet Address:</h4>
                            <div class="url" id="walletAddress"></div>
                            
                            <h4>Private Key (KEEP SECRET):</h4>
                            <div class="private-key" id="privateKeyDisplay"></div>
                            
                            <h4>QR Code:</h4>
                            <div class="qr-code" id="qrCode"></div>
                        </div>
                    </div>
                    
                    <div class="instructions">
                        <strong>Security Best Practices:</strong>
                        <ul style="margin-left: 20px; margin-top: 8px;">
                            <li>Never share your private key</li>
                            <li>Keep multiple backups in secure locations</li>
                            <li>Use this wallet offline only</li>
                            <li>Verify all transactions before signing</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div id="transactions" class="tab-content">
                <div class="section">
                    <h2>üìù Transaction Management</h2>
                    <div class="instructions">
                        <p><strong>Offline Transaction Signing:</strong></p>
                        <ol style="margin-left: 20px; margin-top: 8px;">
                            <li>Create unsigned transaction on online device</li>
                            <li>Transfer transaction file to USB</li>
                            <li>Sign transaction offline using this interface</li>
                            <li>Transfer signed transaction back to online device</li>
                        </ol>
                    </div>
                    
                    <div class="file-input">
                        <p><strong>Load Unsigned Transaction:</strong></p>
                        <input type="file" id="transactionFile" accept=".json" />
                        <button class="button" onclick="loadTransaction()">Load Transaction</button>
                    </div>
                    
                    <div id="transactionDisplay">
                        <!-- Transaction details will be displayed here -->
                    </div>
                </div>
            </div>

            <div id="backup" class="tab-content">
                <div class="section">
                    <h2>üíæ Backup & Recovery</h2>
                    <div class="security-section">
                        <h3>üå± Seed Phrase</h3>
                        <p>Your 12-word recovery phrase:</p>
                        <div class="seed-phrase" id="seedPhraseDisplay">
                            Click "Generate Seed Phrase" to create a new recovery phrase
                        </div>
                        <button class="button" onclick="generateSeedPhrase()">Generate Seed Phrase</button>
                        <button class="button" onclick="downloadBackup()">Download Backup</button>
                    </div>
                    
                    <div class="instructions">
                        <strong>Recovery Instructions:</strong>
                        <ol style="margin-left: 20px; margin-top: 8px;">
                            <li>Write down your seed phrase on paper</li>
                            <li>Store in multiple secure locations</li>
                            <li>Never store digitally or take photos</li>
                            <li>Test recovery process before using</li>
                        </ol>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h2>‚öôÔ∏è USB Setup</h2>
                <div class="instructions">
                    <strong>Required Folder Structure:</strong>
                    <pre style="background: #f3f4f6; padding: 12px; border-radius: 6px; margin-top: 8px;">
USB-2C-WALLET/
‚îú‚îÄ‚îÄ wallets/          (JSON wallet files)
‚îú‚îÄ‚îÄ gallery/user/     (Downloaded images)
‚îú‚îÄ‚îÄ keys/             (Private keys - encrypted)
‚îú‚îÄ‚îÄ transactions/     (Signed transactions)
‚îú‚îÄ‚îÄ backups/          (Recovery backups)
‚îú‚îÄ‚îÄ config/           (Configuration)
‚îú‚îÄ‚îÄ wallet.html       (This file)
‚îî‚îÄ‚îÄ installer.txt     (Setup guide)
                    </pre>
                </div>
            </div>
        </div>
        
        <div class="footer">
            Generated by USB-2C-WALLET v2.1 | Professional Cold Storage Solution
        </div>
    </div>

<!--1principio-->
<script>
let loadedWallets = [];
let currentKeys = null;
let currentSeedPhrase = null;

function showTab(tabName) {
  document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
  document.getElementById(tabName).classList.add('active');
  event.target.classList.add('active');
}

function generateKeys() {
  const privateKey = Array.from(crypto.getRandomValues(new Uint8Array(32)), byte => byte.toString(16).padStart(2, '0')).join('');
  const address = 'pi1' + privateKey.substring(0, 39);
  currentKeys = { privateKey, address };
  document.getElementById('keyStatus').textContent = 'Generated';
  document.getElementById('walletAddress').textContent = address;
  document.getElementById('privateKeyDisplay').textContent = privateKey;
  const qrContainer = document.getElementById('qrCode');
  qrContainer.innerHTML = "";
  new QRCode(qrContainer, { text: address, width: 128, height: 128, correctLevel: QRCode.CorrectLevel.H });
  document.getElementById('keyDisplay').style.display = 'block';
}

function clearKeys() {
  if (confirm('Are you sure you want to clear all keys? This cannot be undone!')) {
    currentKeys = null;
    document.getElementById('keyStatus').textContent = 'Not Generated';
    document.getElementById('keyDisplay').style.display = 'none';
    document.getElementById('qrCode').innerHTML = "";
  }
}

function generateSeedPhrase() {
  const words = ['abandon','ability','able','about','above','absent','absorb','abstract','absurd','abuse','access','accident'];
  const seedWords = [];
  for (let i = 0; i < 12; i++) seedWords.push(words[Math.floor(Math.random() * words.length)]);
  currentSeedPhrase = seedWords.join(' ');
  document.getElementById('seedPhraseDisplay').textContent = currentSeedPhrase;
}

function downloadBackup() {
  if (!currentKeys || !currentSeedPhrase) {
    alert('Please generate keys and seed phrase first');
    return;
  }
  const backup = {
    timestamp: new Date().toISOString(),
    address: currentKeys.address,
    seedPhrase: currentSeedPhrase,
    version: '2.1'
  };
  const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'wallet-backup-' + Date.now() + '.json';
  a.click();
  URL.revokeObjectURL(url);
}
<!--1final-->
<!--2principio-->
function loadWallets() {
  const fileInput = document.getElementById('walletFiles');
  const files = fileInput.files;
  if (files.length === 0) {
    alert('Please select wallet JSON files');
    return;
  }
  loadedWallets = [];
  const walletDisplay = document.getElementById('walletDisplay');
  walletDisplay.innerHTML = '';
  Array.from(files).forEach(file => {
    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const wallet = JSON.parse(e.target.result);
        loadedWallets.push(wallet);
        displayWallet(wallet);
        updateBalance();
      } catch (error) {
        console.error('Error parsing wallet file:', file.name, error);
      }
    };
    reader.readAsText(file);
  });
}

function displayWallet(wallet) {
  const walletDisplay = document.getElementById('walletDisplay');
  const walletCard = document.createElement('div');
  walletCard.className = 'wallet-card';

  const isSigned = wallet.signature && wallet.signature.startsWith("sig_");
  const buttonColor = isSigned ? "green" : "red";
  const buttonText = isSigned ? "üîÅ Devolver Imagen Minteada" : "üîí Firma requerida para devolver";
  const buttonDisabled = isSigned ? "" : "disabled";

  walletCard.innerHTML = `
    <h3>${wallet.name || 'Unknown'}</h3>
    <p><strong>Value:</strong> <span class="value">${wallet.value || 0}œÄ</span></p>
    <p><strong>Date:</strong> ${wallet.date || 'Unknown'}</p>
    <p><strong>Network:</strong> ${wallet.network || 'Unknown'}</p>
    <p><strong>Image URL:</strong></p>
    <div class="url">${wallet.imageURL || 'No URL'}</div>
    <button class="button" onclick="downloadImage('${wallet.imageURL}', '${wallet.name}')">Download Image</button>
    <button class="button" onclick="copyURL('${wallet.imageURL}')">Copy URL</button>
    <button class="button" onclick="signWallet('${wallet.id}')">Sign Wallet</button>
    <button class="button" style="background-color: ${buttonColor};" ${buttonDisabled}
      onclick="unmintWallet('${wallet.id}', '${wallet.imageURL}', ${wallet.value})">
      ${buttonText}
    </button>
  `;
  walletDisplay.appendChild(walletCard);
}

function updateBalance() {
  const total = loadedWallets.reduce((sum, wallet) => sum + (wallet.value || 0), 0);
  document.getElementById('balanceDisplay').textContent = total.toFixed(2) + 'œÄ';
}
<!--2final-->
<!--3principio-->
function downloadImage(url, filename) {
  if (!url) {
    alert('No URL available for this image');
    return;
  }
  const a = document.createElement('a');
  a.href = url;
  a.download = filename || 'pi-coin-image';
  a.target = '_blank';
  a.click();
}

function copyURL(url) {
  navigator.clipboard.writeText(url).then(() => {
    alert('URL copied to clipboard!');
  });
}

function signWallet(walletId) {
  if (!currentKeys) {
    alert('Please generate keys first in the Security tab');
    return;
  }
  const signature = 'sig_' + Math.random().toString(36).substring(2, 15);
  alert('Wallet signed with signature: ' + signature);
  const wallet = loadedWallets.find(w => w.id === walletId);
  if (wallet) {
    wallet.signature = signature;
    displayWallet(wallet);
    updateBalance();
  }
}

function unmintWallet(walletId, imageURL, amount) {
  if (!currentKeys) {
    alert("Please generate keys first in the Security tab.");
    return;
  }

  const transaction = {
    action: "unmint",
    walletId: walletId,
    imageURL: imageURL,
    from: currentKeys.address,
    amount: amount,
    timestamp: new Date().toISOString(),
    signature: "sig_" + Math.random().toString(36).substring(2, 15)
  };

  alert("‚úÖ Imagen marcada para devoluci√≥n. Transacci√≥n registrada en el historial.");

  loadedWallets = loadedWallets.filter(w => w.id !== walletId);
  document.getElementById('walletDisplay').innerHTML = '';
  loadedWallets.forEach(displayWallet);
  updateBalance();

  const logEntry = document.createElement('div');
  logEntry.className = 'transaction-entry';

  const text = `‚úÖ ${amount}œÄ devueltos por imagen ${walletId} el ${new Date().toLocaleString()} | Direcci√≥n: ${transaction.from} | Firma: ${transaction.signature}`;

  logEntry.innerHTML = `
    <span>${text} üíæ</span>
    <button onclick="borrarEntrada(this)">üóëÔ∏è</button>
    <button onclick="descargarEntrada('${text}')">üíæ</button>
  `;

  document.getElementById('transactionLog').appendChild(logEntry);
}

function borrarEntrada(button) {
  const entry = button.parentElement;
  entry.remove();
}

function descargarEntrada(texto) {
  const blob = new Blob([texto], { type: "text/plain" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "transaccion-" + Date.now() + ".txt";
  a.click();
  URL.revokeObjectURL(a.href);
}
<!--3final-->
<!--4principio-->
function loadTransaction() {
  const fileInput = document.getElementById('transactionFile');
  const file = fileInput.files[0];
  if (!file) {
    alert('Please select a transaction file');
    return;
  }
  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const transaction = JSON.parse(e.target.result);
      displayTransaction(transaction);
    } catch (error) {
      alert('Error parsing transaction file');
    }
  };
  reader.readAsText(file);
}

function displayTransaction(transaction) {
  const display = document.getElementById('transactionDisplay');
  display.innerHTML = `
    <div class="wallet-card">
      <h3>Transaction Details</h3>
      <p><strong>To:</strong> ${transaction.to || 'Unknown'}</p>
      <p><strong>Amount:</strong> ${transaction.amount || 0}œÄ</p>
      <p><strong>Fee:</strong> ${transaction.fee || 0}œÄ</p>
      <button class="button" onclick="signTransaction()">Sign Transaction</button>
      <button class="button" onclick="rejectTransaction()">Reject</button>
    </div>
  `;
}

function signTransaction() {
  if (!currentKeys) {
    alert('Please generate keys first');
    return;
  }
  alert('Transaction signed successfully!');
}

function rejectTransaction() {
  document.getElementById('transactionDisplay').innerHTML = '';
  alert('Transaction rejected');
}

window.onload = function() {
  console.log('USB-2C-WALLET Professional Interface Loaded');
};

function guardarHistorialEnUSB() {
  const entries = document.querySelectorAll('.transaction-entry');
  if (entries.length === 0) {
    alert("No hay transacciones para guardar.");
    return;
  }

  const transacciones = Array.from(entries).map(entry => ({
    texto: entry.textContent.trim()
  }));

  fetch('http://localhost:3001/guardar-historial', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ transacciones })
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === 'ok') {
      alert(data.mensaje);
    } else {
      alert('Error al guardar el historial.');
    }
  })
  .catch(err => {
    console.error('Error al conectar con el backend:', err);
    alert('No se pudo guardar el historial en el USB.');
  });
}
function guardarHistorialEnUSB() {
  const entries = document.querySelectorAll('.transaction-entry');
  if (entries.length === 0) {
    alert("No hay transacciones para guardar.");
    return;
  }

  const transacciones = Array.from(entries).map(entry => ({
    texto: entry.textContent.trim()
  }));

  fetch('http://localhost:3001/api/guardar-historial', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ transacciones })
  })
  .then(res => res.json())
  .then(data => {
    if (data.status === 'ok') {
      alert(data.mensaje);
    } else {
      alert('Error al guardar el historial.');
    }
  })
  .catch(err => {
    console.error('Error al conectar con el backend:', err);
    alert('No se pudo guardar el historial en el USB.');
  });
}


function toggleDarkMode() {
  document.body.classList.toggle('dark-mode');

  document.querySelectorAll(
    '.wallet-card, .container, .transaction-entry, .button'
  ).forEach(el => el.classList.toggle('dark-mode'));
}





</script>
<!--4final-->






<script src="qrcodejs-master/qrcode.min.js"></script>
</body>
</html>

